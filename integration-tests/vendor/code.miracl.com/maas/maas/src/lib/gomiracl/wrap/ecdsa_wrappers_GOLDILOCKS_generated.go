// Generated by gen/wrappers/main.go from ecdsa_wrappers.go.tmpl.

//go:build !ignoredefaultcurves || GOLDILOCKS

package wrap

import "code.miracl.com/maas/maas/src/lib/gomiracl/bindings"

// ECPKeyPairGenerateGOLDILOCKS is a wrapper of bindings.ECP_GOLDILOCKS_KEY_PAIR_GENERATE.
func ECPKeyPairGenerateGOLDILOCKS(R *bindings.Rand, s []byte) (sResult []byte, W []byte, err error) {

	var sOct *bindings.Octet
	if s != nil {
		sOct = bindings.NewOctet(s)
		defer sOct.Free()
	} else {
		sSize := bindings.EGSGOLDILOCKS
		sOct = bindings.MakeOctet(sSize)
		defer sOct.Free()
	}

	WSize := 2*bindings.EFSGOLDILOCKS + 1
	WOct := bindings.MakeOctet(WSize)
	defer WOct.Free()

	err = bindings.ECPKeyPairGenerateGOLDILOCKS(R, sOct, WOct)

	sResult = sOct.ToBytes()

	W = WOct.ToBytes()

	return
}

// ECPPublicKeyValidateGOLDILOCKS is a wrapper of bindings.ECP_GOLDILOCKS_PUBLIC_KEY_VALIDATE.
func ECPPublicKeyValidateGOLDILOCKS(W []byte) (err error) {

	WOct := bindings.NewOctet(W)
	defer WOct.Free()

	err = bindings.ECPPublicKeyValidateGOLDILOCKS(WOct)

	return
}

// ECPSpDsaGOLDILOCKS is a wrapper of bindings.ECP_GOLDILOCKS_SP_DSA.
func ECPSpDsaGOLDILOCKS(h int, R *bindings.Rand, key []byte, s []byte, M []byte) (c []byte, d []byte, err error) {

	keyOct := bindings.NewOctet(key)
	defer keyOct.Free()

	sOct := bindings.NewOctet(s)
	defer sOct.Free()

	MOct := bindings.NewOctet(M)
	defer MOct.Free()

	cSize := bindings.EGSGOLDILOCKS
	cOct := bindings.MakeOctet(cSize)
	defer cOct.Free()

	dSize := bindings.EGSGOLDILOCKS
	dOct := bindings.MakeOctet(dSize)
	defer dOct.Free()

	err = bindings.ECPSpDsaGOLDILOCKS(h, R, keyOct, sOct, MOct, cOct, dOct)

	c = cOct.ToBytes()

	d = dOct.ToBytes()

	return
}

// ECPVpDsaGOLDILOCKS is a wrapper of bindings.ECP_GOLDILOCKS_VP_DSA.
func ECPVpDsaGOLDILOCKS(h int, W []byte, M []byte, c []byte, d []byte) (err error) {

	WOct := bindings.NewOctet(W)
	defer WOct.Free()

	MOct := bindings.NewOctet(M)
	defer MOct.Free()

	cOct := bindings.NewOctet(c)
	defer cOct.Free()

	dOct := bindings.NewOctet(d)
	defer dOct.Free()

	err = bindings.ECPVpDsaGOLDILOCKS(h, WOct, MOct, cOct, dOct)

	return
}
